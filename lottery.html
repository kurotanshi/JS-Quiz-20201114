<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>五倍樂透手動選號機</title>
  <style type="text/css">
    .wrap{
      padding: 1em;
    }
    button{
      font-size: 22px;
    }
    .lottery-nums{
      overflow: hidden;
      width: 600px;
    }

    .lottery-nums > div{
      display: block; 
      float: left;
      width: 25px; 
      height: 25px;
      border: 1px solid #999;
      background-color: #fff;
      color: #555;
      font-size: 20px;
      padding: 10px;
      text-align: center;
      line-height: 25px;
      margin-right: 10px;
      margin-bottom: 10px;
    }

    .lottery-nums .selected{
      background-color: green;
      color: #fff;
    }

    .lottery-nums .highlight{
      background-color: red;
      color: #fff;
    }

    .lottery-nums .selected.highlight{
      background-color: yellow;
      color: #333;
    }

    .lottery-result span span{
        display: inline-block;
        width: 30px;
        height: 30px;
        text-align: center;         
        background: orange;
        border: 1px solid red;
        padding: 5px;
        border-radius: 25px;
        margin-left: 5px;
        margin-right: 5px;
        font-size: 26px;
    }
  </style>
</head>
<body>

<div class="wrap">

    <div class="lottery-nums"></div>
    <div class="lottery-result">開獎號碼: <span></span></div>

    <p>
      <button class="btn-lottery">兌獎</button>
      <button class="reset">重設</button>
    </p>

  </div>

  <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>

  <!--
  延續先前範例
    • 1. 將數字區塊變成可以讓使⽤者點選號碼的按鈕。
    • 2. 判斷使⽤者是否選擇了六個號碼
    • 對獎時，搭配先前做的「五倍樂透⾃動選號機」產⽣的號碼進⾏比對。
  -->
  
  <script type="text/javascript">
  let i;
  let lottery = [];

  // 產生 49 顆按鈕
  for(i = 1; i < 50; i++ ){
    $('.lottery-nums').append('<div>' + i + '</div>');
    lottery.push(i);
  }

  // 1. 為數字按鈕加入事件
  $('.lottery-nums div').on('click', ckickNumEvent);

  function ckickNumEvent (){
         
    if($(this).hasClass("selected"))
    {
        $(this).removeClass("selected")
    }
    else
    {
        var lotteryNumsLength = $('div.selected').length;
        if(lotteryNumsLength == 6)
        {
            alert('只能選6個數字!!');
        }
        else
        {
            $(this).addClass("selected");
        }
    }  
  }

  // 重設按鈕
  $('.reset').on('click', function(){
    $('.lottery-nums div').removeClass('selected');
    $('.lottery-nums div').removeClass('highlight');
    $('.lottery-nums div').off('click');
    $('.lottery-nums div').on('click', ckickNumEvent);
    $(".lottery-result > span").empty();
    $('.btn-lottery').attr('disabled', false);
  });

  // 兌獎按鈕
  $('.btn-lottery').on('click', function(){

    var lotteryNumsLength = $('div.selected').length;
    if(lotteryNumsLength < 6)
    {
        alert('請選取6個數字，才可進行兌獎');
    }
    else
    {
        if(!$(".lottery-result > span").text())
        {
            lottery.forEach(function(el, idx){
                var random = Math.floor(Math.random() * lottery.length);
                [lottery[idx], lottery[random]] = [lottery[random], lottery[idx]]
            });

            var lotteryResult = lottery.filter(function(el, idx, array){
              return idx < 6;
            });

            lotteryResult.sort(function(a, b){
                return a - b;
            });

            for(i = 0; i < 6; i++)
            {
                var value = Number(lotteryResult[i]);
                $(".lottery-result > span").append(`<span class=''>${value}</span>`);
                $(".lottery-nums div").eq(value - 1).addClass("highlight");
            }

            $('.lottery-nums div').off('click');
            $('.btn-lottery').attr('disabled', true);
        }
    }
  });

  </script>

</body>
</html>
